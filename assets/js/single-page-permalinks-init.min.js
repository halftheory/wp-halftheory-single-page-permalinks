(function(b,h){function l(b,c){b()?c():window.setTimeout(l.bind(null,b,c),100)}function m(b){var c=b.split("#")[0];return c!==h?c:b}function n(b){b=b.split("#")[1];return b!==h?b:!1}var p=function(){history.pushState("",document.title,window.location.pathname+window.location.search)},r=function(){function k(){!1!==d&&(f[d]!==h&&b("#"+f[d]).removeClass(a.prefix+"-"+a.behavior_open).addClass(a.prefix+"-"+a.behavior_close).fadeOut("fast"),p(),d=!1,b("html,body").animate({scrollTop:0},"slow"))}function c(e){0!==
e&&(e=e.replace(/[^A-Za-z0-9-]/,"").toLowerCase());if(d!==e){var g=!1,c=function(){!1!==g&&g!==h&&(!1!==d?b("#"+f[d]).removeClass(a.prefix+"-"+a.behavior_open).addClass(a.prefix+"-"+a.behavior_close).fadeOut("fast",function(){b("#"+g).fadeIn("fast").removeClass(a.prefix+"-"+a.behavior_close).addClass(a.prefix+"-"+a.behavior_open)}):b("#"+g).fadeIn("fast").removeClass(a.prefix+"-"+a.behavior_close).addClass(a.prefix+"-"+a.behavior_open),0===e?p():window.location.hash=e,d=e,b("html,body").animate({scrollTop:0},
"slow"))};if(f[e]!==h)g=f[e],c();else{var k=!1;b.post(a.ajaxurl,{action:a.prefix+"_get_post",post_name:e},function(c){dataHTML=b("<span></span>").html(c).find("."+a.classPost).first();if(!dataHTML){var d=postHome.prop("tagName").toLowerCase();dataHTML=b("<span></span>").html(c).find(d).first()}dataHTML&&(dataHTML.addClass(a.prefix+"-"+a.behavior_close).hide().appendTo(postHome.parent()),g=f[e]=dataHTML.attr("id"))},"html").always(function(){k=!0});l(function(){return k},c)}}}var a={prefix:"singlepagepermalinks",
home_url:m(window.location.toString()),behavior_open:"slideInFromBottom",behavior_close:"slideOutToBottom",behavior_escape:!0};"object"===typeof singlepagepermalinks&&b.extend(!0,a,singlepagepermalinks);a.classPost=a.prefix+"-post";a.classClose=a.prefix+"-close";if(b("."+a.classPost)[0]){postHome=b("."+a.classPost+":eq(0)");var f={0:postHome.attr("id")},d=0;b("body").on("click","."+a.classClose,function(a){a.preventDefault();k();return!1});a.behavior_escape&&b(document).keyup(function(a){27==a.keyCode&&
k()});b("body").on("click","a",function(e){var d=b(this).attr("href");if(d==a.home_url)return e.preventDefault(),c(0),!1;var f=n(d);if(f&&m(d)==a.home_url)return e.preventDefault(),c(f),!1});var q=n(window.location.href);q&&c(q)}};b(document).ready(function(){r()})})(jQuery);