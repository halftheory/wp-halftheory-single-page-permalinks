(function(b,h){function k(b,c){b()?c():window.setTimeout(k.bind(null,b,c),100)}function l(b){var c=b.split("#")[0];return c!==h?c:b}function m(b){b=b.split("#")[1];return b!==h?b:!1}var n=function(){history.pushState("",document.title,window.location.pathname+window.location.search)},r=function(){function f(){!1!==d&&(g[d]!==h&&b("#"+g[d]).removeClass(a.prefix+"-"+a.behavior_open).addClass(a.prefix+"-"+a.behavior_close).fadeOut("fast"),n(),d=!1,b("html,body").animate({scrollTop:0},"slow"))}function c(e){if(d!==
e){var c=!1,p=function(){!1!==c&&(!1!==d?b("#"+g[d]).removeClass(a.prefix+"-"+a.behavior_open).addClass(a.prefix+"-"+a.behavior_close).fadeOut("fast",function(){b("#"+c).fadeIn("fast").removeClass(a.prefix+"-"+a.behavior_close).addClass(a.prefix+"-"+a.behavior_open)}):b("#"+c).fadeIn("fast").removeClass(a.prefix+"-"+a.behavior_close).addClass(a.prefix+"-"+a.behavior_open),0===e?n():window.location.hash=e,d=e,b("html,body").animate({scrollTop:0},"slow"))};if(g[e]!==h)c=g[e],p();else{var f=!1;b.post(a.ajaxurl,
{action:a.prefix+"_get_post",post_name:e},function(d){dataHTML=b("<span></span>").html(d).find("."+a.classPost).first();if(!dataHTML){var f=postHome.prop("tagName").toLowerCase();dataHTML=b("<span></span>").html(d).find(f).first()}dataHTML&&(dataHTML.addClass(a.prefix+"-"+a.behavior_close).hide().appendTo(postHome.parent()),c=g[e]=dataHTML.attr("id"))},"html").always(function(){f=!0});k(function(){return f},p)}}}var a={prefix:"singlepagepermalinks",home_url:l(window.location.toString()),behavior_open:"slideInFromBottom",
behavior_close:"slideOutToBottom",behavior_escape:!0};"object"===typeof singlepagepermalinks&&b.extend(!0,a,singlepagepermalinks);a.classPost=a.prefix+"-post";a.classClose=a.prefix+"-close";if(b("."+a.classPost)[0]){postHome=b("."+a.classPost+":eq(0)");var g={0:postHome.attr("id")},d=0;b("body").on("click","."+a.classClose,function(a){a.preventDefault();f();return!1});a.behavior_escape&&b(document).keyup(function(a){27==a.keyCode&&f()});b("body").on("click","a",function(d){var e=b(this).attr("href");
if(e==a.home_url)return d.preventDefault(),c(0),!1;var f=m(e);if(f&&l(e)==a.home_url)return d.preventDefault(),c(f),!1});var q=m(window.location.href);q&&c(q)}};b(document).ready(function(){r()})})(jQuery);